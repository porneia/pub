---
layout: post
title: "Miroir, mon beau miroir... L'appel de Reporters sans frontières"
description: ou<br><p style="font-size:large">Comment répondre à l'appel de RSF du 8 février 2012
date: 2012-02-10 12:17:37 +0100
author: al.
mail: porneia[at]free[dot]fr
keywords: Reporters, RSF, HTTrack, clone, censure, doshru.ru, lankaenews.com
license: "BY"
---
<p>
<span class="articleAuthor">Porneia delights, 10 février 2012, {{ page.author }}</span>
&mdash; Nous avons tous encore en tête la
censure qu'à subit Wikileaks courant novembre-décembre 2010 suite à ce
qui fût connu comme étant l'opération <em>Cablegate</em>. Après la
diffusion de plus de 250 000 télégrammes de la diplomatie
états-unienne et relayés par cinq grand journaux, l'association à but
non lucratif s'était vu subir une censure d'un niveau encore rarement
atteint. Après la condamnation du geste de Wikileaks par de nombreux
pays ainsi que par l'OTAN, le gouvernement états-unien, usant de tout
son poid, avait réussi à faire fermer une partie de l'hébergement du
site chez Amazon &mdash; entre autres &mdash; ; avait pressé Paypal de
geler leur compte empêchant ainsi les dons &mdash; entre autres
&mdash; ; avait fait pression sur Visa et Mastercard pour qu'il soit
impossible de transférer de l'argent vers Wikileaks ou encore avait
désactivé le nom de domaine wikileaks.org alors géré par EveryDNS. Les
réactions de nombreuses communautés sur Internet ne se firent pas
attendre. Ainsi que l'explique très
clairement <a href="http://blog.fdn.fr/?post/2010/12/06/FDN-heberge-un-miroir-de-WikiLeaks"
hreflang="fr" class="external">Benjamin Bayart dans son communiqué</a>
lors de la mise en place d'un des miroirs de Wikileaks
sur <abbr title="French Data Network">FDN</abbr>, la question n'était
pas de prendre parti, de &laquo;&nbsp;savoir si ce que fait Wikileaks
est bien ou mal&nbsp;&raquo;. La question était de contrer la
censure. La question était &mdash; et est toujours &mdash; de
continuer à diffuser les données. Car les données sont
essentielles. Car <a href="http://datalove.me/" class="external"
hreflang="en">les données doivent circuler</a>. Ainsi naquirent
d'abord des centaines de nouveau nom de domaine pointant vers les
quelques serveurs de Wikileaks encore en ligne. Ainsi naquirent
ensuite des centaines de miroirs préservant les données de toute
destruction.

<p>
Aujourd'hui encore la censure est présente et toujours plus virulente
de par le monde, tantôt <a href="{{ site.url }}{{ site.baseurl }}/archives/2012.html#0208"
hreflang="fr">s'attaquant à de simples citoyens</a>, tantôt
à <a href="http://www.rue89.com/chinatown/2011/01/05/chine-liu-binyan-journaliste-censure-jusque-sur-sa-tombe-183820"
class="external" hreflang="fr">de véritables institutions</a>. Mais
tous ont le même leïtmotiv : défendre la liberté d'expression et la
libre circulation de l'information. Malheureusement tout le monde ne
bénéficie pas de la vitrine médiatique ou des moyens techniques (ou
plus simplement du savoir-faire) qui permet l'excercice de ces
libertés. Fort de ce constat et &laquo;&nbsp;afin de permettre à des
sites d'information indépendants victimes de cyber-attaques ou de
blocages gouvernementaux de continuer leurs activités de publication
et de diffusion en
ligne, <a href="http://fr.rsf.org/rsf-miroir-08-02-2012,41822.html"
class="external" hreflang="fr">Reporters sans frontières (RSF) se
lance dans la duplication de sites</a>&nbsp;&raquo;. Ce 8 février 2012
c'est par ces mots que RSF a donc commencé à mettre en place des
miroirs du travail de journalistes subissant la censure par filtrages,
attaques en déni de service, retraits de contenus, ou encore &mdash;
plus radical &mdash; par
<a href="http://fr.rsf.org/sri-lanka-pourquoi-et-comment-les-locaux-du-01-02-2011,39437.html"
   class="external" hreflang="fr">mise à feu de locaux</a>.

<p>
Cette mission que se donne RSF a débuté par la duplication de deux
médias en ligne, le magazine tchétchène <a href="http://doshdu.ru/"
class="external" hreflang="ru">Dosh</a> et le journal
sri-lankais <a href="http://lankaenews.rsf.org/" hreflang="en"
class="external">Lanka-e News</a>, et a monté en conséquence deux
miroirs :

<p>
  <ul class="sub">
    <li><a href="http://dosh.rsf.org/" class="external"
           hreflang="ru">http://dosh.rsf.org</a>
    <li><a href="http://lankaenews.rsf.org/" class="external"
           hreflang="fr">http://lankaenews.rsf.org</a>
  </ul>


<p>
RSF nous appelle à les aider à mettre en place des mirroirs de ces
sites qui sont menacés ou qui subissent déjà la censure. En effet leur
miroir par exemple de Lankan-e News permet aux ressortissants
sri-lankais de visiter ce journal depuis leur propre pays malgré
la <a href="http://fr.rsf.org/sri-lanka-sandaruwan-senadheera-redacteur-en-26-10-2011,41276.html"
class="external" hreflang="fr">censure appliquée par leur gouvernement
depuis octobre 2011</a>. Mais ce miroir pourrait être un jour ou
l'autre bloqué à son tour. En multipliant les miroirs, les articles de
ces médias verraient leur libre accessibilité augmenter d'autant
plus. Voici les autres miroirs disponibles
(<ins datetime="2012-02-10T23:25:25+00:00">dernière MàJ le 13 février
2012 12:50 UTC</ins>) :

<p>
  <ul>
    <li><a href="/streisand.me/doshdu.ru/" hreflang="ru">http://porneia.free.fr/streisand.me/doshdu.ru</a>
    <li><a href="/streisand.me/lankaenews.com/" hreflang="en">http://porneia.free.fr/streisand.me/lankaenews.com</a>
    <li><a href="http://katzenpension-schroedinger.de/mirror/dosh.rsf.org/"
           class="external"
           hreflang="ru">http://katzenpension-schroedinger.de/mirror/dosh.rsf.org/</a>
    <li><a href="http://katzenpension-schroedinger.de/mirror/lankaenews.rsf.org/"
           class="external"
           hreflang="en">http://katzenpension-schroedinger.de/mirror/lankaenews.rsf.org/</a>
    <li><a href="http://doshdu.dragondon.net/" class="external"
           hreflang="ru">http://doshdu.dragondon.net/</a>
    <li><a href="http://dosh.daupheus.com/" class="external"
           hreflang="ru">http://dosh.daupheus.com/</a>
    <li><a href="http://lankaenews.daupheus.com/" class="external"
           hreflang="en">http://lankaenews.daupheus.com/</a>
  </ul>

<p>
Il existe bien sûr d'autres sites d'information qui devraient
bénéficier de cette action. Si vous en connaissez, n'hésitez pas à
monter vos propres miroirs et proposer à RSF de les rajouter sur leur
liste.

<h2 class="articleHeadline">Comment participer ?</h2>

<p>
<b>Méthodologie</b> &brvbar; Il suffit pour cela de récupérer une
copie des sites en question, de la déployer sur un serveur web puis
d'envoyer un email à <code>wefightcensorship[at]rsf.org</code> afin
qu'ils rajoutent votre
miroir <a href="http://fr.rsf.org/rsf-miroir-08-02-2012,41822.html"
hreflang="fr" class="external">à la liste</a>. Pour le moment deux
méthodes sont proposées pour récupérer les données :

<p>
  <ul class="sub">
    <li>À l'aide d'<a href="http://www.httrack.com/" class="external"
      hreflang="en">HTTrack</a>, par exemple, qui est un aspirateur de
      site et qui va automatiser le processus de copie.
    <li>En téléchargeant les archives mises à disposition sur chaque
      miroir.
  </ul>

<p>
<b>HTTrack</b> &brvbar; C'est un logiciel libre et gratuit disponible
sous Microsoft Windows et tous les Unix de manière générale (BSD,
GNU/Linux, Mac OS X, etc.). Vous pouvez récupérer le programme sur
la <a href="http://www.httrack.com/page/2/" hreflang="fr"
class="external">page de téléchargement</a> du projet ; notez que
toutes les distributions GNU/Linux et BSD doivent normalement l'avoir
à disposition dans leurs dépôts. Notez aussi qu'HTTrack dispose d'une
interface graphique pour les fanas de la souris,
<a href="http://www.httrack.com/html/shelldoc.html" class="external"
hreflang="en">son utilisation en devient enfantine</a>. Enfin <mark>il
est important que vous pointiez HTTrack sur les miroirs de RSF et non
sur les sites originaux, cela afin de leur épargner autant que
possible une trop forte charge</mark>.

<p>
<b>Archives</b> &brvbar; Chaque miroir devrait mettre à sa racine une
archive du contenu. C'est évidemment plus pratique mais vous êtes
alors dépendant des mises à jour des sites miroirs. Pour le moment
voici les archives mises à disposition
(<ins datetime="2012-02-10T23:25:25+00:00">dernière MàJ le 13 février
2012 12:50 UTC</ins>) :

<p>
  <ul class="sub">
    <li>Reporters sans frontières
      <ul>
        <li><a href="http://dosh.rsf.org/archive.tar"
               class="external">http://dosh.rsf.org/archive.tar</a> <span class="littletxt">(~46M)</span>
        <li><a href="http://lankaenews.rsf.org/archive.tar"
               class="external">http://lankaenews.rsf.org/archive.tar</a>
      </ul>
    <li>Porneia delights
      <ul>
        <li><a href="/streisand.me/doshdu.ru.tar.gz">http://porneia.free.fr/streisand.me/doshdu.ru.tar.gz</a>
        <span class="littletxt">(~10M
          &ndash; <a href="/streisand.me/doshdu.ru.tar.gz.md5sum">md5sum</a>)</span>
        <li><a href="/streisand.me/lankaenews.com.tar.gz">http://porneia.free.fr/streisand.me/lankaenews.com.tar.gz</a> <span class="littletxt">(~45M
            &ndash; <a href="/streisand.me/lankaenews.com.tar.gz.md5sum">md5sum</a>)</span>
      </ul>
    <li>Katzenpension-Schroedinger
      <ul>
        <li><a href="http://katzenpension-schroedinger.de/mirror/dosh.rsf.org.archive.bz2"
               class="external">http://katzenpension-schroedinger.de/mirror/dosh.rsf.org.archive.bz2</a> <span class="littletxt">(~12M)</span>
        <li><a href="http://katzenpension-schroedinger.de/mirror/lankaenews.rsf.org.tar.bz2"
               class="external">http://katzenpension-schroedinger.de/mirror/lankaenews.rsf.org.tar.bz2</a> <span class="littletxt">(~600M)</span>
      </ul>
    <li>DragonDon
      <ul>
        <li><a href="http://doshdu.dragondon.net/archive.tar"
               class="external">http://doshdu.dragondon.net/archive.tar</a> <span class="littletxt">(~91M)</span>
      </ul>
  </ul>

<div style="font-size:small;line-height:1em;">
<p>
Note : les archives <code>.tar</code>, <code>.tar.gz</code>
et <code>.tar.bz2</code> se décompressent très simplement
avec <a href="http://www.7-zip.org/" class="external"
hreflang="en">7-zip</a> (libre et gratuit) sous Microsoft Windows et
avec <a href="http://wakaba.c3.cx/s/apps/unarchiver" class="external"
hreflang="en">The Unarchiver</a> (libre et gratuit) sous Mac OS X.
</div>

<p>
<b>Ressources requises</b> &brvbar; En quelques mots : un serveur http
(Apache, nginx, lighttpd, <del>IIS</del>, etc.) et 300Mo de
place. N'importe quel serveur http fait l'affaire bien sûr. Le contenu
étant statique, il n'est pas nécessaire d'avoir PHP ou SQL à
disposition. Les archives à elles seules font pour le moment moins de
55Mo pour une taille d'environ 268Mo une fois décompressées.

<p>
<b>À quelle fréquence faire les copies ?</b> &brvbar; Un site
d'information est en constante évolution évidemment. Après que nous
les ayons contacté, RSF nous a indiqué qu'ils réalisaient des copies
toutes les 24 heures. Les réplications des miroirs secondaires peuvent
donc, dans le cas où elles sont automatisées, être faites toutes les
24 à 48 heures selon les conseils de RSF. Dans le cas où vous feriez la
copie manuellement (à l'aide d'HTTrack tout de même) une mise à jour
par semaine pourrait être suffisante.

<p>
<b>Je souhaite mettre en place un miroir mais je n'ai pas de serveur
web</b> &brvbar; Plusieurs solutions s'offrent à vous. Tout d'abord si
vous avez l'habitude de laisser votre ordinateur allumé 24/7 vous
pouvez envisager d'héberger le contenu sur votre ordinateur. Si vous
êtes néophytes <a href="http://www.auto-hebergement.fr/"
class="external" hreflang="fr">en matière d'auto-hébergement</a> il
existe de nombreuses solutions faciles <em>tout-en-un</em> à mettre en
place pour <a href="http://www.wampserver.com/en/" class="external"
hreflang="en">Windows</a>, <a href="http://www.mamp.info/"
class="external" hreflang="en">Mac OS X</a>, GNU/Linux
(<a href="http://doc.ubuntu-fr.org/lamp" class="external"
hreflang="fr">GLAMP</a> sous Ubuntu par exemple) entre autres. Après
l'ouverture
de <a href="http://www.numerama.com/f/46422-t-tutorial-configuration-routeur-pc.html"
class="external" hreflang="fr">votre port 80</a> et l'utilisation d'un
service comme dyndns vous pourriez diffuser vos contenus. Vous pouvez
aussi envisager de plaider votre cause après d'un des hébergeurs
du <a href="http://www.rhien.org" class="external"
hreflang="fr">Réseau d’Hébergeurs Indépendants et ENgagés</a>, ou
encore vous inscrire sur <a href="http://www.toile-libre.org/"
class="external" hreflang="fr">Toile Libre</a> par exemple (prix
libre, nécessite d'être actif au sein de l'association, partisant
du <abbr title="Do It Yourself">DIY</abbr>), voir même choisir parmi
une <a href="http://www.commentcamarche.net/faq/1624-choisir-un-hebergeur-gratuit-ou-payant"
class="external" hreflang="fr">liste d'hébergeur gratuit et
payant</a>. <mark>Attention, si vous passez par des hébergeurs
indépendants et/ou associatifs, veuillez à mettre au courant
l'administrateur de vos intentions. En effet, il est possible que vos
miroirs &mdash; et donc potentiellement tout l'espace de l'hébergeur
&mdash; soit blacklisté dans certaines parties du monde, voir même
&mdash; bien que ça soit très peu probable &mdash; attaqué d'une
manière ou d'une autre.</mark>

<h2 class="articleHeadline">En pratique</h2>

<p>
<b>&laquo;&nbsp;Tout est une copie d'une copie d'une
copie&hellip;&nbsp;&raquo;</b> &brvbar; Nous allons développer ici la
manière dont nous avons automatiser le processus de réplication des
deux miroirs de RSF. Elle est loin d'être parfaite mais à tout le
moins <em>çamarche&copy;</em>. Cela correspond évidemment à nos
besoins et devrait, si vous comptez la réutiliser, être adapter pour
satisfaire les vôtres. En substance, sur une Debian GNU/Linux, nous
dupliquons les miroirs avec HTTrack directement dans nos archives sur
un réseau local. Une fois fait nous synchronisons les répertoires des
deux sites depuis le réseau local vers les répertoires présent dans la
copie locale primaire du site du Porneia delights à l'aide de
rsync. Pour finir cette copie locale est mise à jour avec la version
en ligne grâce à lftp. Le tout étant lancé automatiquement par un
tâche cron tous les jours.

<p>
<b>Script</b> &brvbar; Nous utilisons un simple script bash pour faire
tout le travail. Il se
nomme <a href="{{ site.url }}{{ site.baseurl }}/code/mirror-rsf.sh"><code>mirror-rsf.sh</code></a>
et vous pouvez pratiquement l'utiliser en l'état en prenant la peine
de modifier les quelques variables en tête du script
(notamment <code>MIRROR</code> et <code>WWW</code>). Notez que le
script va vérifier si des mirroirs existent déjà localement. Ainsi si
c'est le premier lancement du script, il créera automatiquement les
mirroirs ainsi que leurs archives (tar avec compression gzip). Lors
des lancements suivants, il mettra simplement tout cela à jour. Enfin,
chose importante, si vous avez un httpd sur votre serveur et que vous
n'avez donc pas besoin de mettre à jour un serveur ftp distant, pensez
à supprimer ou commenter les lignes concernant lftp en bas du
script. (<ins datetime="2012-02-10T23:25:25+00:00">dernière MàJ le 24
février 2012 14:31 UTC</ins>) :

{% highlight bash %}
#!/bin/bash

# We are the Porneia delights. We are persistent and reluctant.
# We also do not really come from outer space.
# http://porneia.free.fr

# Version: 0.2
# Time-stamp: <2012-02-20 14:25:53>

# This script replicates http://dosh.rsf.org and http://lankaenews.rsf.org
# See http://en.rsf.org/rwb-mirror-censorship-08-02-2012,41825.html
# for more details

# Released under WTFPLv2/Beer-ware License (Revision 42)

# Depends: httrack, rsync, lftp,
#          cigarettes without additives
#          and C8H10N4O2.

#### Change this variable to feet your needs
MIRROR="/mnt/data78/rsf"
WWW="$HOME/www/streisand.me"
FTP_USER="user"
FTP_PASS="password"
FTP_PORT="21"
FTP_HOST="ftpserveur.com"
FTP_PATH="/streisand.me/"

#### Ok, here we go

# Check for httrack
echo -en $(date --rfc-3339=seconds)": Checking for HTTrack..."
if [[ -z $(which httrack) ]]; then
    echo 1>&2 "Error: could not find httrack."
    echo 1>&2 $(date --rfc-3339=seconds)": Exiting. Please install httrack."
    exit 1
fi
echo "done."

# Check for lftp
echo -en $(date --rfc-3339=seconds)": Checking for lftp..."
if [[ -z $(which lftp) ]]; then
    echo 1>&2 "Error: could not find lftp."
    echo 1>&2 $(date --rfc-3339=seconds)": Exiting. Please install lftp."
    exit 1
fi
echo "done."

# Check if $WWW exist
echo -en $(date --rfc-3339=seconds)": Does $WWW exist?..."
if [[ ! -d "$WWW" ]]; then
    echo "no."
    echo -en "\nError: "$WWW" does not exist, please create this folder.\n"
    exit 1
else
    echo "yes."
fi

# Check if $MIRROR exist
echo -en $(date --rfc-3339=seconds)": Does "$MIRROR" exist?..."
if [[ ! -d "$MIRROR" ]]; then
    echo "no."
    echo -en "\nError: "$MIRROR" does not exist, please create this folder.\n"
    exit 1
else
    echo "yes."
fi

# Launching httrack
echo -en $(date --rfc-3339=seconds)": Launching httrack "
LOCKFILE="$MIRROR/hts-in_progress.lock"

[ -f "$LOCKFILE" ] && { echo "... Already running. Exiting.";exit 0; }
if [[ -d "$MIRROR/hts-cache" ]];then
    echo "for update, please fasten your seatbelt."
    PARAMS="-O $MIRROR -q -iC2 -X"
else
    echo "for the fist time, please fasten your seatbelt."
    PARAMS="http://dosh.rsf.org http://lankaenews.rsf.org -O $MIRROR -q -%v1 -r4"
fi
echo ""
httrack $PARAMS

sleep 1

# Starting rsync
echo -en "\n"$(date --rfc-3339=seconds)": Starting rsync..."
rsync --delete -rtoqu $MIRROR/dosh.rsf.org/ $WWW/doshdu.ru/
rsync --delete -rtoqu $MIRROR/lankaenews.rsf.org/ $WWW/lankaenews.com/
echo "done."

# Fixing modes
echo -en $(date --rfc-3339=seconds)": Fixing modes in "$WWW"..."
find $WWW -type d -exec chmod 755 {} \;
find $WWW -type f -exec chmod 644 {} \;
echo "done."

# Archives and md5sum
echo $(date --rfc-3339=seconds)": Building archives and md5sum..."
cd $WWW
echo -en "   * doshdu.ru.tar.gz..."
tar cf - doshdu.ru | gzip -c > doshdu.ru.tar.gz
echo "done."
echo -en "   * doshdu.ru.tar.gz.md5sum..."
md5sum doshdu.ru.tar.gz > doshdu.ru.tar.gz.md5sum
echo "done."
echo -en "   * lankaenews.com.tar.gz..."
tar cf - lankaenews.com | gzip -c > lankaenews.com.tar.gz
echo "done."
echo -en "   * lankaenews.com.tar.gz.md5sum..."
md5sum lankaenews.com.tar.gz > lankaenews.com.tar.gz.md5sum
echo "done."
cd $HOME

# Then push local copy online using lftp
# Note that you may add "set ftp:list-options -a;" before
# "open" to lftp commands in case your ftp server hide
# dot-files by default (e.g. .htaccess), and show them only when LIST
# command is used with -a command.  Please see lftp man for further
# details.
echo $(date --rfc-3339=seconds)": Local copy of "$WWW" is going to be pushed..."
lftp -c "open -u $FTP_USER,$FTP_PASS -p $FTP_PORT $FTP_HOST;
         lcd $WWW;
         cd $FTP_PATH;
         mirror --delete --reverse --verbose"

echo $(date --rfc-3339=seconds)": All done."
{% endhighlight %}

<p>
Le script est tout à fait perfectible nous en avons parfaitement
conscience. Pour le moment il arrive cependant à nous satisfaire. Nous
sommes malgré tout ouvert à toutes remarques et critiques à son
propos.
